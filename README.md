# Co-project-BBT

- - -

## 简介

仪器构造参考[VzBot330](https://github.com/VzBoT3D/VzBoT-Vz330)，使用了Frame,Z Group与Bed的结构，并对enclosure的顶板与底板进行了小修改，以适应项目需求。

## 目录结构

**code/** : 存放核心程序代码

**api/** : 存放接口文件，接口主要用于为**core/**内

**db/** : 存放与数据库交互，操作数据库的相关文件

**lib/** : 存放程序中常用的自定义模块

**conf/**: 存放配置文件

**run.py** : 启动文件

**setup.py** : 安装，部署程序的脚本

**requirements.txt** : 存放软件依赖的第三方python包列表

**README.md** : 项目说明文件

### **code/**

#### ImgPreprocessing.py
图像预处理程序。将原始图像转化为矩阵，并通过灰度化与二值化处理为识别程序运算的布尔值矩阵。


- - -
## 硬件协议

### 步进电机

#### 步进电机型号

步进电机使用两相闭环42步进电机，电源由驱动器提供，扭矩0.7N.m。

不选用开环步进电机的原因：开环步进电机没有闭环步进的编码器。无法对电机当前的位置进行有效监测与反馈，特别是在高加速度的情况下，电机容易发生丢步。为了防止丢步的发生，故开环电机的功率输出会受到一定的限制。故多方权衡下，我们选择了闭环电机进行z轴驱动。

关于加速度的计算，需要结合皮带传动效率，丝杆传动效率，丝杆参数和电机扭矩综合计算，更多的需要在实验中进行验证。

#### 步进电机驱动器

步进电机驱动器为HBS57。驱动器控制信号由 **使能信号ENA**，**方向信号DIR**，**脉冲信号PUL** 组成。通过读取配置文件来获知输入是共阳接法或是共阴接法，从而决定引脚输出信号的方式。

项目使用Raspberry Pi4B, 引脚**GPIO.1(BCM-18)** 与 **GPIO.4(BCM-23)** 分别用于 **DIR** 与 **PUL** 通讯。

编码开关和细分数的关系如下所示,项目选择5000的细分数。

![编码开关和细分数的关系](https://raw.githubusercontent.com/FerdinandLin/img/main/2022/project_bbt/sw%26microsteps.png)


## PCB
### 目标
将现有电器零件连接集成于PCB上。

现有需连接部件
+ 树莓派
  - 安装座(M2贴片螺母)
  - IO口
  - USB电源(稳压)
+ HBS57
  - 24V电源供电
  - 24V信号
+ 24V开关电源
  - 电源输入
+ 显示屏
  - USB电源
+ 激光光源
  - USB电源
